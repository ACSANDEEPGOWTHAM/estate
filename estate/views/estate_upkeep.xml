<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>
        <!-- Inherit view -->
        <record id="inherited_account_analytic_account_timesheet_form" model="ir.ui.view">
            <field name="name">account.analytic.account.invoice.form.inherit</field>
            <field name="model">account.analytic.account</field>
            <field name="inherit_id" ref="analytic.view_account_analytic_account_form"/>
            <field name="arch" type="xml">
                <xpath expr='//div[@name="project"]' position='inside'>
                    <field name="use_estate"/>
                    <label for="use_estate"/>
                </xpath>
            </field>
        </record>


        <!-- Search View -->
        <record id="upkeep_activity_view_search" model="ir.ui.view">
            <field name="name">Upkeep Activity Search</field>
            <field name="model">estate.upkeep.activity</field>
            <field name="priority" eval="1"/>
            <field name="arch" type="xml">
                <search>
                    <field name="activity_id"/>
                    <field name="upkeep_date"/>
                    <filter name="filter_new" string="Draft/Confirmed"
                            domain="[('state', 'in', ('draft','confirmed'))]"/>
                    <filter name="filter_approved" string="Approved"
                            domain="[('state', '=', 'approved')]"/>
                    <filter name="filter_correction" string="Correction"
                            domain="[('state', '=', 'correction')]"/>
                    <filter name="filter_payslip" string="Payslip"
                            domain="[('state', '=', 'payslip')]"/>
                    <filter name="filter_month" icon="terp-go-month" string="This Month"
                            domain="[('upkeep_date','&lt;=',(context_today()+relativedelta(day=31)).strftime('%%Y-%%m-%%d')), ('upkeep_date','&gt;=',(context_today()-relativedelta(day=1)).strftime('%%Y-%%m-%%d'))]"/>
                    <filter name="filter_year" icon="terp-go-year" string="This Year"
                            domain="[('upkeep_date','&lt;=',(context_today()+relativedelta(day=31, month=12)).strftime('%%Y-%%m-%%d')), ('upkeep_date','&gt;=',(context_today()-relativedelta(day=1, month=1)).strftime('%%Y-%%m-%%d'))]"/>

                    <group string="Group By">
                        <filter name="by_activity" string="Activity"
                                context="{'group_by': 'activity_id'}"/>
                        <filter name="by_date" string="Date"
                                context="{'group_by': 'upkeep_date'}"/>
                    </group>
                </search>
            </field>
        </record>

        <record id="upkeep_labour_view_search" model="ir.ui.view">
            <field name="name">Upkeep Labour Search</field>
            <field name="model">estate.upkeep.labour</field>
            <field name="priority" eval="1"/>
            <field name="arch" type="xml">
                <search>
                    <field name="employee_id"/>
                    <field name="upkeep_team_id"/>
                    <field name="upkeep_date"/>
                    <field name="activity_id"/>
                    <field name="location_id"/>
                    <filter name="filter_new" string="Draft/Confirmed"
                            domain="[('state', 'in', ('draft','confirmed'))]"/>
                    <filter name="filter_approved" string="Approved"
                            domain="[('state', 'in', ('approved', 'correction', 'payslip'))]"/>
                    <separator/>
                    <filter name="filter_month" icon="terp-go-month" string="This Month"
                            domain="[('upkeep_date','&lt;=',(context_today()+relativedelta(day=31)).strftime('%%Y-%%m-%%d')), ('upkeep_date','&gt;=',(context_today()-relativedelta(day=1)).strftime('%%Y-%%m-%%d'))]"/>
                    <filter name="filter_year" icon="terp-go-year" string="This Year"
                            domain="[('upkeep_date','&lt;=',(context_today()+relativedelta(day=31, month=12)).strftime('%%Y-%%m-%%d')), ('upkeep_date','&gt;=',(context_today()-relativedelta(day=1, month=1)).strftime('%%Y-%%m-%%d'))]"/>
                    <group string="Group By">
                        <filter name="by_division" string="Division"
                                context="{'group_by': 'division_id'}"/>
                        <filter name="by_team" string="Team"
                                context="{'group_by': 'upkeep_team_id'}"/>
                        <!-- Hold cross team implementation
                        <filter name="by_cross_team" string="Team (Cross Team)"
                                context="{'group_by': 'number_of_day_team_id'}"/>
                        -->
                        <filter name="by_employee" string="Employee"
                                context="{'group_by': 'employee_id'}"/>
                        <filter name="by_date" string="Month"
                                context="{'group_by': 'upkeep_date'}"/>
                        <filter name="by_activity" string="Activity"
                                context="{'group_by': 'activity_id'}"/>
                    </group>
                </search>
            </field>
        </record>

        <!--
        <record id="inherited_view_seed_batch_form" model="ir.ui.view">
            <field name="name">view_seed_batch_form.inherit</field>
            <field name="model">estate.nursery.batch</field>
            <field name="inherit_id" ref="view_seed_batch_form"/>
            <field name="arch" type="xml">
                <xpath expr='//group[@name="top_right"]' position='inside'>
                    <group name="account" string="Account">
                        <field name="account_income_id"/>
                        <field name="account_expense_id"/>
                    </group>
                </xpath>
            </field>
        </record>
        -->

        <!-- Upkeep -->
        <record id="upkeep_view_search" model="ir.ui.view">
            <field name="name">Upkeep Search</field>
            <field name="model">estate.upkeep</field>
            <field name="priority" eval="1"/>
            <field name="arch" type="xml">
                <search>
                    <field name="team_id"/>
                    <field name="division_id"/>
                    <field name="estate_id"/>
                    <separator/>
                    <field name="date"/>
                    <filter name="filter_new" string="Draft/Confirmed"
                            domain="[('state', 'in', ('draft','confirmed'))]"/>
                    <filter name="filter_approved" string="Approved"
                            domain="[('state', '=', 'approved')]"/>
                    <filter name="filter_correction" string="Correction"
                            domain="[('state', '=', 'correction')]"/>
                    <filter name="filter_payslip" string="Payslip"
                            domain="[('state', '=', 'payslip')]"/>
                    <filter icon="terp-go-month" string="This Month"
                            domain="[('date','&lt;=',(context_today()+relativedelta(day=31)).strftime('%%Y-%%m-%%d')), ('date','&gt;=',(context_today()-relativedelta(day=1)).strftime('%%Y-%%m-%%d'))]"/>
                    <group string="Group By">
                        <filter name="by_team" string="Team"
                                context="{'group_by': 'team_id'}"/>
                        <filter name="by_date" string="Date"
                                context="{'group_by': 'date'}"/>
                    </group>
                </search>
            </field>
        </record>

        <record id="upkeep_view_tree" model="ir.ui.view" >
            <field name="name">Upkeep Tree</field>
            <field name="model">estate.upkeep</field>
            <field name="priority" eval="1"/>
            <field name="arch" type="xml">
                <tree colors="red:state in ('draft','confirmed')">
                    <field name="date"/>
                    <field name="estate_id"/>
                    <field name="division_id"/>
                    <field name="team_id"/>
                    <field name="assistant_id"/>
                    <!-- do not remove -->
                    <field name="state" invisible="True"/>
                </tree>
            </field>
        </record>

        <record id="upkeep_view_form" model="ir.ui.view" >
            <field name="name">Upkeep Form</field>
            <field name="model">estate.upkeep</field>
            <field name="priority" eval="1"/>
            <field name="arch" type="xml">
                <form string="Upkeep">
                    <header>
                        <button class="oe_highlight" name="button_confirmed" string="Confirmed"
                                type="object" states="draft" groups="estate.group_assistant"/>
                        <button class="oe_highlight" name="button_approved" string="Approved"
                                type="object" states="confirmed" groups="estate.group_manager"/>
                        <field name="state" widget="statusbar"
                               statusbar_visible="draft,confirmed,approved,payslip"/>
                    </header>
                    <sheet string="Upkeep">
                        <div class="oe_title">
                            <label string="Daily Upkeep Draft " attrs="{'invisible': [('state','!=','draft')]}"/>
                            <label string="Daily Upkeep " attrs="{'invisible': [('state','=', 'draft')]}"/>
                            <h1>
                                <field name="name" readonly="1"/>
                            </h1>
                        </div>
                        <group>
                            <group name="team_work">
                                <field name="date" attrs="{'readonly': [('state','not in',('draft','confirmed'))]}"/>
                                <field name="team_id" options="{'no_create_edit': True}"
                                       attrs="{'readonly': [('state','not in',('draft','confirmed'))]}"/>
                                <field name="assistant_id" options="{'no_create_edit': True}"
                                        attrs="{'readonly': [('state','not in',('draft','confirmed'))]}"/>
                                <!-- do not remove -->
                                <field name="max_day" invisible="True"/>
                            </group>
                            <group name="division_information">
                                <field name="division_id" options="{'no_create_edit': True}"
                                        attrs="{'readonly': [('state','not in',('draft','confirmed'))]}"/>
                                <field name="estate_id" options="{'no_create_edit': True}"
                                        attrs="{'readonly': [('state','not in',('draft','confirmed'))]}"/>
                            </group>
                        </group>
                        <notebook>
                            <page string="Upkeep Activity">
                                <field name="activity_line_ids" attrs="{'readonly': [('state','not in',('draft','confirmed'))]}">
                                    <tree editable="true">
                                        <field name="activity_id"
                                               options="{'no_create_edit': True}"/>
                                        <field name="contract" string="Ctr." attrs="{'invisible': [('activity_contract', '=', False)]}"/>
                                        <field name="location_ids"
                                               options="{'no_create_edit': True}"
                                               widget="many2many_tags"
                                               domain="[('inherit_location_id.location_id', '=', division_id)]"/>
                                        <field name="unit_amount" string="Qty."/>
                                        <field name="activity_uom_id" readonly="True"
                                               string="UoM"/>
                                        <field name="amount"/>
                                        <!-- do not remove field below -->
                                        <field name="division_id" invisible="True"/>
                                        <field name="account_id" options="{'no_create_edit': True}" invisible="False"/>
                                        <field name="upkeep_id" invisible="True"/>
                                        <field name="activity_contract" invisible="True"/>
                                    </tree>
                                </field>
                            </page>
                            <page string="Labour">
                                <div class="oe_button_box oe_right">
                                    <button string="Calculate Qty"
                                            name="calculate_labour_qty"
                                            type="object"
                                            help="Calculate labour's work result which has attendance code. It will reset previous entry."
                                            attrs="{'invisible': [('state', '!=', 'draft')]}"/>
                                    <button string="Reset"
                                            name="reset_all_quantity"
                                            type="object"
                                            help="Reset all quantity, overtime, piece rate"
                                            attrs="{'invisible': [('state', '!=', 'draft')]}"/>
                                </div>
                                <field name="labour_line_ids" attrs="{'readonly': [('state','not in',('draft','confirmed'))]}">
                                    <tree editable="True" colors="orange:prod_quantity_day&lt;100">
                                        <field name="employee_id" string="Employee" options="{'no_create_edit': True}"/>
                                        <field name="nik_number" string="NIK" readonly="True"/>
                                        <field name="activity_id" string="Activity"
                                                options="{'no_create_edit': True}"/>
                                        <field name="location_id" string="Location" options="{'no_create_edit': True}"/>
                                        <field name="planted_year_id" string="PY"/>
                                        <field name="attendance_code_id" string="Attn."
                                                options="{'no_create': True}"/>
                                        <field name="quantity" string="Qty."/>
                                        <field name="activity_uom_id" string="UoM" readonly="True"/>
                                        <field name="quantity_overtime" widget="float_time" string="OT"
                                            attrs="{'readonly':[('activity_wage_method','!=','attendance')]}"/>
                                        <field name="quantity_piece_rate" string="PR"
                                            attrs="{'readonly':[('activity_wage_method','!=','standard')]}"/>
                                        <field name="amount" groups="estate.group_assistant"/>
                                        <field name="prod_quantity_day" string="Prod (%)" groups="estate.group_assistant"/>
                                        <!-- do not remove field below -->
                                        <field name="activity_location_ids" invisible="True"/>
                                        <field name="ratio_quantity_day" string="Q/D" invisible="True" groups="estate.group_assistant"/>
                                        <field name="ratio_day_quantity" string="D/Q" invisible="True" groups="estate.group_assistant"/>
                                        <field name="ratio_wage_quantity" string="W/Q" invisible="True" groups="estate.group_assistant"/>
                                        <field name="upkeep_id" invisible="True"/>
                                        <field name="division_id" invisible="True"/>
                                        <field name="number_of_day" invisible="True"/>
                                        <field name="wage_number_of_day" invisible="True"/>
                                        <field name="wage_overtime" invisible="True"/>
                                        <field name="wage_piece_rate" invisible="True"/>
                                        <field name="activity_contract" invisible="True"/>
                                        <field name="activity_wage_method" invisible="True"/>
                                        <field name="cross_team_id" invisible="True"/>
                                    </tree>
                                </field>
                            </page>
                            <page string="Material">
                                <field name="material_line_ids" attrs="{'readonly': [('state','not in',('draft','confirmed'))]}">
                                    <tree editable="True" colors="orange: ratio_product_activity != prod_product_activity">
                                        <!-- TODO add future feature - proposed material? -->
                                        <field name="product_id" string="Material" options="{'no_create': True}"/>
                                        <field name="unit_amount" string="Qty."/>
                                        <field name="product_uom_id" string="UoM"/>
                                        <field name="amount"/>
                                        <field name="activity_id" string="Activity" options="{'no_create': True}"/>
                                        <field name="location_id"/>
                                        <field name="activity_uom_id" string="UoM"/>
                                        <!-- Do not remove field below -->
                                        <field name="activity_unit_amount" string="Act. Qty." invisible="True"/>
                                        <field name="ratio_product_activity" string="Ratio"/>
                                        <field name="prod_product_activity" string="Norm" invisible="True" groups="estate.estate_manager"/>
                                        <field name="division_id" invisible="True"/>
                                        <field name="upkeep_id" invisible="True"/>
                                        <!--<field name="activity_unit_amount" string="Qty. Act"/>-->
                                        <!--<field name="ratio_product_activity" string="Ratio"/>-->
                                        <!-- -->
                                    </tree>
                                </field>
                            </page>
                        </notebook>
                        <label string="Comment"/>
                        <field name="comment" attrs="{'readonly': [('state','not in',('draft','confirmed'))]}"/>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers"/>
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
                </form>
            </field>
        </record>

        <record id="upkeep_activity_view_form" model="ir.ui.view">
            <field name="name">Upkeep Activity Form</field>
            <field name="model">estate.upkeep.activity</field>
            <field name="priority" eval="1"/>
            <field name="arch" type="xml">

                <form name="estate.upkeep.activity">
                    <header>
                        <field name="state" widget="statusbar"
                               statusbar_visible="draft,confirmed,approved,payslip"/>
                    </header>
                    <sheet>
                        <div class="oe_title">
                            <label for="Upkeep" class="oe_edit_only"/>
                            <h1>
                                <field name="upkeep_id" readonly="True"/>
                            </h1>
                            <field name="division_id" readonly="True"/>
                        </div>
                        <group>
                            <group name="top" colspan="4">
                                <field name="activity_id" readonly="True"
                                       options="{'no_create': True}"/>
                                <field name="activity_uom_id" readonly="True"
                                       string="Unit" options="{'no_create': True}"/>
                                <field name="location_ids" readonly="True"
                                       options="{'no_create': True}"
                                       widget="many2many_tags"/>
                                <field name="unit_amount"/>
                            </group>
                        </group>
                        <notebook>
                            <page name="labour" string="Labour">
                                <group>
                                    <field name="labour_unit_amount"/>
                                    <field name="labour_number_of_day"/>
                                    <field name="labour_overtime_amount"/>
                                    <field name="labour_piece_rate_amount"/>
                                </group>
                            </page>
                            <page name="account" string="Account">
                                <group>
                                    <group name="cost">
                                        <field name="labour_amount" string="Labour Wage"/>
                                        <field name="material_amount" string="Material Cost"/>
                                        <field name="amount" string="Activity Cost"/>
                                    </group>
                                    <group name="account">
                                        <field name="account_id" options="{'no_create': True}"/>
                                    </group>
                                </group>
                            </page>
                            <page name="productivity" string="Productivity">
                                <group name="productivity">
                                    <label for="ratio_quantity_day"/>
                                    <div>
                                        <field name="ratio_quantity_day" class="oe_inline"/> unit/day
                                    </div>
                                    <label for="ratio_day_quantity"/>
                                    <div>
                                        <field name="ratio_day_quantity" class="oe_inline"/> day/unit
                                    </div>
                                    <label for="ratio_wage_quantity"/>
                                    <div>
                                        <!-- TODO get currency from context -->
                                        <field name="ratio_wage_quantity" class="oe_inline"/> currency/unit
                                    </div>
                                </group>
                            </page>
                        </notebook>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers"/>
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
                </form>
            </field>
        </record>

        <!-- Upkeep -->
        <record id="upkeep_labour_view_form" model="ir.ui.view">
            <field name="name">Labour Form</field>
            <field name="model">estate.upkeep.labour</field>
            <field name="priority" eval="1"/>
            <field name="arch" type="xml">
                <form>
                    <header>
                        <field name="state" widget="statusbar"
                               statusbar_visible="draft,confirmed,approved,payslip"/>
                    </header>

                    <sheet>
                        <div class="oe_button_box oe_right" style="color:orange"
                             attrs="{'invisible': [('prod_quantity_day','&gt;=', 100)]}"
                                placeholder="Productivity is less than 100%">
                            <i class="fa fa-exclamation-circle fa-2x fa-fw"></i>
                            <field name="prod_quantity_day" invisible="True"/>
                        </div>
                        <div class="oe_title">
                            <label for="Upkeep" class="oe_edit_only"/>
                            <h1>
                                <field name="upkeep_id" readonly="True"/>
                            </h1>
                            <field name="division_id" readonly="True"/>
                        </div>

                        <group>
                            <group name="top">
                                <field name="employee_id" attrs="{'readonly': [('state','not in',('draft','confirmed'))]}"/>
                                <field name="contract_type" readonly="True"/>
                                <field name="contract_period" readonly="True"/>
                                <field name="upkeep_team_employee_id" string="Team Leader" attrs="{'readonly': [('state','not in',('draft','confirmed'))]}"/>
                            </group>

                        </group>
                        <notebook>
                            <page name="labour_activity" string="Activity">
                                <group>
                                    <group>
                                        <field name="activity_id" attrs="{'readonly': [('state','not in',('draft','confirmed'))]}"/>
                                        <field name="activity_uom_id" readonly="True" class="oe_inline"/>
                                        <field name="location_id" attrs="{'readonly': [('state','not in',('draft','confirmed'))]}"/>
                                    </group>
                                    <group>
                                        <field name="quantity" attrs="{'readonly': [('state','not in',('draft','confirmed'))]}"/>
                                        <field name="quantity_overtime" widget="float_time" attrs="{'readonly': [('state','not in',('draft','confirmed'))]}"/>
                                        <field name="quantity_piece_rate" attrs="{'readonly': [('state','not in',('draft','confirmed'))]}"/>
                                    </group>
                                </group>
                            </page>
                            <page name="labour_wage" string="Wage">
                                <group>
                                    <group name="wage">
                                        <field name="wage_number_of_day"/>
                                        <field name="wage_overtime"/>
                                        <field name="wage_piece_rate"/>
                                    </group>
                                    <group name="amount">
                                        <field name="amount" string="Total Amount"/>
                                    </group>
                                </group>
                            </page>
                            <page name="productivity" string="Attendance &amp; Productivity">
                                <group>
                                    <group name="attendance">
                                        <field name="activity_contract"/>
                                        <field name="attendance_code_id" attrs="{'readonly': [('state','not in',('draft','confirmed'))]}"/>
                                        <field name="number_of_day"/>
                                    </group>
                                    <group name="productivity">
                                        <field name="ratio_quantity_day"/>
                                        <field name="ratio_day_quantity"/>
                                        <field name="ratio_wage_quantity"/>
                                    </group>
                                </group>
                            </page>
                        </notebook>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers"/>
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
                </form>
            </field>
        </record>

        <record id="upkeep_labour_view_tree" model="ir.ui.view" >
            <field name="name">Upkeep Labour Tree</field>
            <field name="model">estate.upkeep.labour</field>
            <field name="priority" eval="1"/>
            <field name="context" eval="{'search_default_employee_id': 1}"/>
            <field name="arch" type="xml">
                <tree colors="red:state in ('draft','confirmed');orange:prod_quantity_day&lt;100">
                    <!--
                    Use 2 decimal digits to shorten width
                    -->
                    <field name="upkeep_date" string="Date"/>
                    <field name="upkeep_team_id" string="Team" invisible="True"/>
                    <field name="employee_id" string="Employee" invisible="True"/>
                    <field name="activity_id" string="Activity"/>
                    <field name="activity_uom_id" string="UoM"/>
                    <field name="quantity" digits="(8,2)" string="Qty."/>
                    <field name="location_id" string="Location"/>
                    <field name="planted_year_id" string="PY"/>
                    <field name="number_of_day" string="Day(s)" sum="Day(s)"/>
                    <field name="quantity_overtime" digits="(8,2)" string="OT" sum="OT"/>
                    <field name="quantity_piece_rate" digits="(8,2)" string="PR"/>
                    <field name="ratio_quantity_day" digits="(8,2)" string="Q/D"/>
                    <field name="ratio_day_quantity" digits="(8,2)" string="D/Q"/>
                    <field name="ratio_wage_quantity" digits="(12,2)" string="W/Q"/>
                    <!-- remove to shorten tree
                    <field name="wage_number_of_day" string="W_HK" groups="base.group_hr_manager,estate.group_assistant"/>
                    <field name="wage_overtime" string="W_OT" groups="base.group_hr_manager,estate.group_assistant"/>
                    <field name="wage_piece_rate" string="W_PR" groups="base.group_hr_manager,estate.group_assistant"/>
                    -->
                    <field name="amount" string="Wage" sum="Wage"/>
                    <field name="prod_quantity_day" string="Prod (%)" avg="Productivity"/>
                    <field name="state" invisible="True"/>
                </tree>
            </field>
        </record>

        <record id="upkeep_lha_view_tree" model="ir.ui.view" >
            <field name="name">Upkeep LHA Tree</field>
            <field name="model">estate.upkeep.labour</field>
            <field name="priority" eval="1"/>
            <field name="context" eval="{'search_default_division_id': 1}"/>
            <field name="arch" type="xml">
                <tree colors="red:state in ('draft','confirmed');orange:prod_quantity_day&lt;100">
                    <field name="upkeep_date" string="Date"/>
                    <field name="employee_id"/>
                    <field name="location_id" string="Block"/>
                    <field name="planted_year_id" string="PY"/>
                    <field name="quantity" string="Qty."/>
                    <field name="number_of_day" string="Day(s)" sum="Day(s)"/>
                    <field name="quantity_overtime" string="OT" sum="OT"/>
                    <field name="quantity_piece_rate" string="PR"/>
                    <field name="amount" string="Wage" sum="Wage"/>
                    <field name="ratio_quantity_day" string="Q/D"/>
                    <field name="ratio_day_quantity" string="D/Q"/>
                    <field name="ratio_wage_quantity" string="W/Q"/>
                    <field name="prod_quantity_day" string="Prod (%)" avg="Productivity"/>
                    <field name="state" invisible="True"/>
                </tree>
            </field>
        </record>


        <record id="upkeep_material_view_tree" model="ir.ui.view">
            <field name="name">Upkeep Material Tree</field>
            <field name="model">estate.upkeep.material</field>
            <field name="priority" eval="1"/>
            <field name="arch" type="xml">
                <tree colors="red:state in ('draft','confirmed')">
                    <field name="upkeep_date" string="Date"/>
                    <field name="product_id" string="Material" invisible="True"/>
                    <field name="unit_amount" string="Qty."/>
                    <field name="product_uom_id" string="UoM"/>
                    <field name="activity_id" string="Activity"/>
                    <field name="activity_uom_id" string="UoM"/>
                    <field name="activity_unit_amount" string="Act. Qty."/>
                    <field name="amount" string="Cost"/>
                    <field name="ratio_product_activity" string="P/A"/>
                    <!-- invisible field -->
                    <field name="state" invisible="True"/>
                </tree>
            </field>
        </record>

        <record id="upkeep_material_view_search" model="ir.ui.view">
            <field name="name">Upkeep Material Search</field>
            <field name="model">estate.upkeep.material</field>
            <field name="priority" eval="1"/>
            <field name="arch" type="xml">
                <search>
                    <field name="activity_id"/>
                    <field name="product_id"/>
                    <filter name="filter_new" string="Draft/Confirmed"
                            domain="[('state', 'in', ('draft','confirmed'))]"/>
                    <filter name="filter_approved" string="Approved"
                            domain="[('state', '=', 'approved')]"/>
                    <filter name="filter_approved" string="Correction"
                            domain="[('state', '=', 'correction')]"/>
                    <filter name="filter_approved" string="Payslip"
                            domain="[('state', '=', 'payslip')]"/>
                    <filter name="filter_month" icon="terp-go-month" string="This Month"
                            domain="[('upkeep_date','&lt;=',(context_today()+relativedelta(day=31)).strftime('%%Y-%%m-%%d')), ('upkeep_date','&gt;=',(context_today()-relativedelta(day=1)).strftime('%%Y-%%m-%%d'))]"/>
                    <filter name="filter_year" icon="terp-go-year" string="This Year"
                            domain="[('upkeep_date','&lt;=',(context_today()+relativedelta(day=31, month=12)).strftime('%%Y-%%m-%%d')), ('upkeep_date','&gt;=',(context_today()-relativedelta(day=1, month=1)).strftime('%%Y-%%m-%%d'))]"/>

                    <group string="Group By">
                        <filter name="by_activity" string="Activity"
                                context="{'group_by': 'activity_id'}"/>
                        <filter name="by_product" string="Material"
                                context="{'group_by': 'product_id'}"/>
                        <filter name="by_date" string="Date"
                                context="{'group_by': 'upkeep_date'}"/>
                    </group>
                </search>
            </field>
        </record>

        <record id="upkeep_material_view_form" model="ir.ui.view">
            <field name="name">Material Usage Form</field>
            <field name="model">estate.upkeep.material</field>
            <field name="priority" eval="1"/>
            <field name="arch" type="xml">
                <form>
                    <header>
                        <field name="state" widget="statusbar"
                               statusbar_visible="draft,confirmed,approved,payslip"/>
                    </header>
                    <sheet>
                        <div class="oe_title">
                            <label for="Upkeep" class="oe_edit_only"/>
                            <h1>
                                <field name="upkeep_id" readonly="True"/>
                            </h1>
                        </div>

                        <group>
                            <group name="material">
                                <field name="product_id" readonly="True"/>
                                <field name="product_uom_id"/>
                                <field name="unit_amount" readonly="True"/>
                                <field name="amount"/>
                            </group>
                            <group name="activity">
                                <field name="activity_id" attrs="{'readonly': [('state','not in',('draft','confirmed'))]}"/>
                                <field name="activity_uom_id"/>
                                <field name="activity_unit_amount"/>
                                <field name="ratio_product_activity"/>
                            </group>
                        </group>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers"/>
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
                </form>
            </field>
        </record>

        <record id="action_list_upkeep" model="ir.actions.act_window" >
            <field name="name">Upkeep</field>
            <field name="res_model">estate.upkeep</field>
            <field name="view_mode">tree,form</field>
            <field name="context">{'search_default_filter_new': 1}</field>
        </record>

        <menuitem id="estate_operation_menu" name="Operation" parent="main_estate_menu" sequence="10"
                groups="estate.group_user"/>

        <menuitem id="estate_upkeep" name="Daily Upkeep"
                  parent="estate_operation_menu"
                  action="action_list_upkeep"
                  groups="estate.group_user"/>

        <menuitem id="estate_operation_control_menu" name="Operation Control" parent="main_estate_menu" sequence="20"
                groups="estate.group_assistant"/>

        <!--<record id="action_list_estate_division_lha_report" model="ir.actions.act_window" >-->
            <!--<field name="name">Division LHA Report</field>-->
            <!--<field name="res_model">estate.upkeep.labour</field>-->
            <!--<field name="view_type">tree</field>-->
            <!--<field name="view_mode">tree</field>-->
            <!--<field name="view_id" ref="estate_division_lha_view_tree"/>-->
            <!--<field name="context">{'search_default_filter_month': 1, 'search_default_by_division': 1, 'search_default_by_activity': 1}</field>-->
        <!--</record>-->

        <!--<record id="action_list_upkeep_labour" model="ir.actions.act_window" >-->
            <!--<field name="name">Upkeep Labour</field>-->
            <!--<field name="res_model">estate.upkeep.labour</field>-->
            <!--<field name="view_mode">tree,form</field>-->
            <!--<field name="context">{'search_default_filter_month': 1, 'search_default_by_employee': 1}</field>-->
        <!--</record>-->

        <record id="action_list_upkeep_lha" model="ir.actions.act_window" >
            <field name="name">Division Report</field>
            <field name="res_model">estate.upkeep.labour</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="estate.upkeep_lha_view_tree"/>
            <field name="context">{'search_default_by_division': 1, 'search_default_by_activity': 1}</field>
        </record>

        <menuitem id="estate_division_lha_report" name="Division Upkeep"
                  parent="estate_operation_control_menu"
                  action="action_list_upkeep_lha"
                  groups="estate.group_assistant"/>

        <!-- Use Division Upkeep re it shows work result -->
        <!--
        <record id="upkeep_activity_view_tree" model="ir.ui.view" >
            <field name="name">Upkeep Activity Tree</field>
            <field name="model">estate.upkeep.activity</field>
            <field name="priority" eval="1"/>
            <field name="arch" type="xml">
                <tree string="Upkeep Activity" colors="red:state in ('draft','confirmed')">
                    <field name="upkeep_date"/>
                    <field name="activity_id"/>
                    <field name="activity_uom_id" string="UoM"/>
                    <field name="location_ids" string="Location"/>
                    <field name="labour_unit_amount" string="Target Qty."/>
                    <field name="labour_overtime_amount" string="OT"/>
                    <field name="labour_piece_rate_amount" string="PR"/>
                    <field name="amount" string="Cost" sum="Cost"/>
                    <field name="ratio_quantity_day" string="Q/D"/>
                    <field name="ratio_day_quantity" string="D/Q"/>
                    <field name="ratio_wage_quantity" string="W/Q"/>
                    <field name="state" invisible="True"/>
                </tree>
            </field>
        </record>
        -->

        <!-- Wizard -->
        <record id="estate_division_report_view_form" model="ir.ui.view">
            <field name="name">Estate Division Report View Form</field>
            <field name="model">estate.division.report</field>
            <field name="arch" type="xml">
                <form string="Estate Division Report Options">
                    <group colspan="4">
                        <field name="period"/>
                        <field name="date_start"/>
                        <field name="date_end"/>
                        <!-- todo fix wrapper to print estate or division report -->
                        <!--
                        <field name="type"/>
                        <field name="estate_id" attrs="{'invisible': [('type', 'not in', ('estate', 'division'))], 'required': [('type', '=', 'estate')]}"/>
                        <field name="division_id" attrs="{'invisible': [('type', '!=', 'division')], 'required': [('type', '=', 'division')]}"/>
                        -->
                        <field name="type" invisible="True"/>
                        <field name="estate_id" required="True"/>
                        <field name="division_id" required="True"/>

                    </group>
                    <footer>
                        <button name="check_report" string="Print" type="object" default_focus="1" class="oe_highlight"/>
                        or
                        <button string="Cancel" class="oe_link" special="cancel" />
                    </footer>
                </form>
            </field>
        </record>

        <!-- Use Division Upkeep re it shows work result -->
        <!--
        <record id="action_list_upkeep_activity" model="ir.actions.act_window" >
            <field name="name">Upkeep Activity</field>
            <field name="res_model">estate.upkeep.activity</field>
            <field name="view_mode">tree,form</field>
            <field name="context">{'search_default_by_activity': 1, 'search_default_filter_month': 1}</field>
        </record>

        <menuitem id="estate_upkeep_activity" name="Upkeep Activity"
                  parent="estate_operation_menu"
                  action="action_list_upkeep_activity"
                  groups="estate.group_user"/>
        -->
        <record id="action_list_upkeep_labour" model="ir.actions.act_window" >
            <field name="name">Upkeep Labour</field>
            <field name="res_model">estate.upkeep.labour</field>
            <field name="view_mode">tree,form</field>
            <field name="context">{'search_default_filter_month': 1, 'search_default_by_employee': 1}</field>
        </record>

        <menuitem id="estate_upkeep_labour" name="Labour Usage"
                  parent="estate_operation_menu"
                  action="action_list_upkeep_labour"
                  groups="estate.group_user"/>

        <record id="action_list_upkeep_material" model="ir.actions.act_window" >
            <field name="name">Upkeep Material</field>
            <field name="res_model">estate.upkeep.material</field>
            <field name="view_mode">tree,form</field>
            <field name="context">{'search_default_by_product': 1, 'search_default_filter_month': 1}</field>
        </record>

        <menuitem id="estate_upkeep_material" name="Material Usage"
                  parent="estate_operation_menu"
                  action="action_list_upkeep_material"
                  groups="estate.group_user"/>

        <record id="estate_division_report_action" model="ir.actions.act_window" >
            <field name="name">Estate Division Report</field>
            <field name="res_model">estate.division.report</field>
            <field name="type">ir.actions.act_window</field>
            <field name="view_mode">form</field>
            <field name="view_type">form</field>
            <field name="view_id" ref="estate_division_report_view_form"/>
            <field name="target">new</field>
        </record>

        <menuitem id="estate_division_report_menu" name="Estate Division Report"
                  parent="estate.menu_estate_reporting"
                  action="estate_division_report_action"
                  groups="estate.group_user"/>
    </data>
</openerp>