<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>
        <!-- View Search -->
        <record id="search_view_estate_parameter" model="ir.ui.view">
            <field name="name">Estate Parameter</field>
            <field name="model">estate.parameter.value</field>
            <field name="arch" type="xml">
                <search string="Parameter">
                    <group expand='1' string='Group by...'>
                        <filter name="group_parameter" string='Parameter' domain="[]" context="{'group_by' : 'parameter_id'}"/>
                    </group>
                </search>
            </field>
        </record>

        <!-- View Tree: Estate Structure -->
        <record model="ir.ui.view" id="view_form_location_inherited">
            <field name="name">Location - Estate Extension</field>
            <field name="model">stock.location</field>
            <field name="inherit_id" ref="stock.view_location_form"/>
            <field name="arch" type="xml">
                <group string="Additional Information" position="after">
                    <group string="Estate Location Information">
                        <field name="estate_location"/>
                        <field name="estate_location_level"/>
                        <field name="estate_location_type"/>
                    </group>
                </group>
            </field>
        </record>

        <!-- View: Block -->
        <record id="view_tree_block_config" model="ir.ui.view">
            <field name="name">Block Configuration</field>
            <field name="model">estate.block.template</field>
            <field name="priority">1</field>
            <field name="arch" type="xml">
                <tree string="Estate Block"
                      default_order="complete_name"
                      colors="blue:estate_location_level!='3'">
                    <field name="complete_name"/>
                    <field name="estate_location_type"/>
                    <field name="estate_location_level"/>
                    <field name="usage"/>
                    <field name="company_id" groups="base.group_multi_company"/>
                </tree>
            </field>
        </record>

        <record id="view_form_block_config" model="ir.ui.view">
            <field name="name">Block Configuration Form</field>
            <field name="model">estate.block.template</field>
            <field name="priority">1</field>
            <field name="arch" type="xml">
                <form string="Block">
                    <sheet>
                        <label for="name" class="oe_edit_only"/>
                        <h1><field name="name"/></h1>
                        <label for="location_id" class="oe_edit_only"/>
                        <h2><field name="location_id"/></h2>

                        <group string="Location">
                            <field name="estate_location" required="True"/>
                            <field name="estate_location_level" required="True"/>
                            <field name="estate_location_type" required="True"/>
                            <field name="assistant_id"/>
                        </group>

                        <group name="account" string="Account">
                            <field name="account_id"/>
                        </group>

                        <group string="Areal Statement" attrs="{'invisible': [('estate_location_type','=', 'nursery')]}">
                            <field name="planted_year_id"
                                   attrs="{'invisible': [('estate_location_level','in', ('1','2'))]}"/>
                            <field name="qty_tree"/>
                            <field name="qty_tree_immature"/>
                            <field name="qty_tree_mature_normal"/>
                            <field name="qty_tree_mature_abnormal"/>
                            <field name="qty_sph_standard"/>
                            <field name="area_gis"/>
                            <field name="area_planted"/>
                            <field name="area_unplanted"/>
                            <field name="area_emplacement"/>
                        </group>

                        <group string="Assets" attrs="{'invisible': [('estate_location_type','=', 'nursery')]}">
                            <field name="is_smallholder"/>
                            <field name="partner_id" attrs="{'invisible': [('is_smallholder','=', False)]}"/>
                            <field name="company_id" attrs="{'invisible': [('is_smallholder','=', True  )]}"/>
                        </group>

                        <field name="block_parameter_ids"
                               attrs="{'invisible': [('estate_location_level','in', ('1','2'))]}"/>
                    </sheet>
                </form>
            </field>
        </record>

        <record model="ir.ui.view" id="view_block_parameter_tree">
            <field name="name">Block Parameter Tree</field>
            <field name="model">estate.block.parameter</field>
            <field name="priority" eval="1"/>
            <field name="arch" type="xml">
                <tree editable="True">
                    <field name="parameter_id"/>
                    <field name="parameter_value_id"/>
                </tree>
            </field>
        </record>

        <record model="ir.ui.view" id="view_parameter_config_tree">
            <field name="name">Block Parameter Config Tree</field>
            <field name="model">estate.parameter.value</field>
            <field name="priority" eval="1"/>
            <field name="arch" type="xml">
                <tree>
                    <field name="name"/>
                </tree>
            </field>
        </record>



        <!-- Action -->
        <record model="ir.actions.act_window" id="action_list_block_estate">
            <field name="name">Estate Structure (Block)</field>
            <field name="res_model">estate.block.template</field>
            <field name="domain">[('estate_location','=','True')]</field>
            <field name="view_mode">tree,form,geoengine</field>
        </record>

        <record model="ir.actions.act_window" id="action_list_parameter_config">
            <field name="name">Parameter</field>
            <field name="res_model">estate.parameter.value</field>
            <field name="priority">1</field>
            <field name="context">{"search_default_group_parameter": 1}</field>
            <field name="search_view_id" ref="search_view_estate_parameter"/>
            <field name="view_mode">tree,form</field>
        </record>

        <record id="action_list_analytic" model="ir.actions.act_window" >
            <field name="name">Analytic Estate Journal Items</field>
            <field name="res_model">account.analytic.line</field>
            <field name="domain">[('journal_id','=',5)]</field>
            <field name="view_mode">tree,form</field>
        </record>

        <!-- todo action open Activity By Category -->


        <!-- Menu -->
        <menuitem id="main_estate_menu" name="Estate"/>

        <menuitem id="estate_config_menu" name="Configuration" parent="main_estate_menu" sequence="100"/>

        <menuitem id="estate_blocking_menu"
                  name="Estate"
                  parent="estate_config_menu"
                  groups="base.group_no_one"/>

        <menuitem id="estate_estate_block_menu" name="Block Structure"
                  parent="estate_blocking_menu"
                  action="action_list_block_estate"
                  groups="base.group_no_one"/>

        <menuitem id="estate_master_menu" name="Configuration"
                  parent="estate_config_menu"
                  groups="base.group_no_one"/>

        <menuitem id="estate_account_menu" name="Account"
                  parent="estate_config_menu"
                  groups="base.group_no_one"/>

        <menuitem id="estate_account_analytic_menu" name="Analytic Journal Entries"
                  parent="estate_account_menu"
                  action="action_list_analytic"
                  groups="base.group_no_one"/>

        <menuitem id="estate_parameter_menu" name="Parameter"
                  parent="estate_master_menu"
                  action="action_list_parameter_config"
                  groups="base.group_no_one"/>

        <!-- Estate Reporting -->
        <menuitem id="menu_estate_reporting" name="Estate" parent="base.menu_reporting" sequence="5"/>
        <menuitem id="menu_estate_upkeep_reporting" name="Upkeep" parent="estate.menu_estate_reporting" sequence="20"/>
    </data>
</openerp>