<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>
        <template id="report_fingerprint">
            <t t-call="report.html_container">
                <!--global variable-->
                <t t-set="avg_day_work" t-value="0"/>
                <t t-set="avg_day_work_divide" t-value="0"/>
                
                <t t-set="sum_hour_late_office" t-value="0"/>
                <t t-set="sum_hour_late_office_30" t-value="0"/>
                <t t-set="sum_late_amount_office" t-value="0"/>
                <t t-set="sum_late_amount_office_3" t-value="0"/>
                <t t-set="sum_estate_late_amount" t-value="0"/>
                <t t-set="sum_labor_late_circle_amount" t-value="0"/>
                <t t-set="sum_labor_late_circle_amount" t-value="0"/>
                <t t-set="sum_labor_late" t-value="0"/>
                <t t-set="sum_labor_late_amount" t-value="0"/>

                <t t-set="sum_hour_late_office_person" t-value="0"/>
                <t t-set="sum_late_amount_office_person" t-value="0"/>
                <t t-set="sum_estate_late_amount_person" t-value="0"/>
                <t t-set="sum_labor_late_circle_amount_person" t-value="0"/>
                <t t-set="sum_labor_late_amount_person" t-value="0"/>

                <t t-set="sum_p_hour_early_leave" t-value="0"/>
                <t t-set="sum_p_early_leave_amount" t-value="0"/>
                <t t-set="sum_p_early_leave_person" t-value="0"/>
                <!--/global variable-->

                <!--page 1-->
                <div class="page">
                    <!-- !important override bootstrap td's -->
                    <style>
                        table.table-condensed td {
                            padding: 2px 4px !important;
                        }

                        .fa-circle-white:before {
                            content: "";
                        }

                        .fa-circle-red:before {
                            content: "\f111";
                            color: red !important;
                        }

                        .fa-circle-gold:before {
                            content: "\f111";
                            color: gold !important;
                        }

                        .fa-circle-black:before {
                            content: "\f111";
                            color: black !important;
                        }

                        .fa-circle-goldenrod:before {
                            content: "\f111";
                            color: goldenrod !important;
                        }

                        @media print {
                            tr.page-break  { page-break-inside: avoid; }
                        }

                    </style>

                    <h2 class="text-center">
                        Laporan Presensi
                        <t t-if="data['form']['office_level_id']"><t t-esc="str(data['form']['office_level_id'][1])"/></t>
                    </h2>
                    <!--header-->
                    <table class="table table-condensed table-borderless" style="font-size:65%;padding:0px;">
                        <tr>
                            <td width="40%">
                                <!--periode-->
                                <table class="table table-condensed" width="auto">
                                    <thead class="thead-inverse">
                                        <tr>
                                            <th colspan="3"><strong>Periode Laporan</strong></th>
                                        </tr>
                                    </thead>
                                    <tr>
                                        <td><strong>Tanggal</strong></td>
                                        <td>
                                            <t t-esc="datetime.datetime.strptime(str(data['form']['date_start']), '%Y-%m-%d').strftime('%d-%b-%Y')"/>
                                            - <t t-esc="datetime.datetime.strptime(str(data['form']['date_end']), '%Y-%m-%d').strftime('%d-%b-%Y')"/>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><strong>Perusahaan</strong></td>
                                        <td><t t-if="data['form']['company_id']"><t t-esc="str(data['form']['company_id'][1])"/></t></td>
                                    </tr>
                                    <tr>
                                        <td><strong>Departemen</strong></td>
                                        <td><t t-if="data['form']['department_id']"><t t-esc="str(data['form']['department_id'][1])"/></t></td>
                                    </tr>
                                    <tr>
                                        <td><strong>Jenis Kantor</strong></td>
                                        <td>
                                            <t t-if="data['form']['office_level_id']"><t t-esc="str(data['form']['office_level_id'][1])"/></t>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><strong>Status Karyawan</strong></td>
                                        <td>
                                            <t t-if="data['form']['contract_type']">
                                                <t t-if="data['form']['contract_type']=='1'">PKWTT</t><t t-if="data['form']['contract_type']=='2'">PKWT</t>
                                            </t>
                                            <t t-if="data['form']['contract_period']">
                                                - <t t-if="data['form']['contract_period']=='1'">Bulanan</t><t t-if="data['form']['contract_period']=='2'">Harian</t>
                                            </t>
                                        </td>
                                    </tr>
                                </table>
                                <!--periode-->
                            </td>
                            <td width="30%">
                                <t t-if="str(data['form']['office_level_id'][1]) != 'Estate'">
                                    <!--keterangan potong poin-->
                                    <table class="table table-condensed" width="auto">
                                        <thead>
                                            <tr><th colspan="4"><strong>Keterangan Potong Poin</strong></th></tr>
                                        </thead>
                                        <tr>
                                            <td width="50" class="text-right"><i class="fa fa-circle-white"/></td>
                                            <td width="10"><strong>0</strong></td>
                                            <td width="50" class="text-right"><i class="fa fa-circle-white"/></td>
                                            <td width="10"><strong>0</strong></td>
                                        </tr>
                                        <tr>
                                            <td width="50" class="text-right"><i class="fa fa-circle-gold"/></td>
                                            <td width="10"><strong>-2</strong></td>
                                            <td width="50" class="text-right"><i class="fa fa-circle-gold"/></td>
                                            <td width="10"><strong>-1</strong></td>
                                        </tr>
                                        <tr>
                                            <td width="50" class="text-right"><i class="fa fa-circle-red"/></td>
                                            <td width="10"><strong>-3</strong></td>
                                            <td width="50" class="text-right"><i class="fa fa-circle-red"/></td>
                                            <td width="10"><strong>-2</strong></td>
                                        </tr>
                                        <tr>
                                            <td width="50" class="text-right"><i class="fa fa-circle-black"/></td>
                                            <td width="10"><strong>-4</strong></td>
                                            <td width="50" class="text-right"><i class="fa fa-circle-black"/></td>
                                            <td width="10"><strong>-3</strong></td>
                                        </tr>
                                    </table>
                                    <!--/keterangan potong poin-->
                                </t>
                            </td>
                            <td width="30%">
                                <t t-if="str(data['form']['office_level_id'][1]) != 'HO'">
                                    <!--keterangan terlambat-->
                                    <table class="table table-condensed" width="auto">
                                        <thead>
                                            <tr>
                                                <th colspan="4"><strong>Keterangan Terlambat</strong></th>
                                            </tr>
                                        </thead>
                                        <tr>
                                            <td width="10"><i class="fa fa-circle-goldenrod"/></td>
                                            <td width="50"><strong>Terlambat kebun/apel pagi/jam kerja</strong></td>
                                            <td width="10"><i class="fa fa-circle-red"/></td>
                                            <td width="50"><strong>Surat teguran terlambat kali kebun</strong></td>
                                        </tr>
                                    </table>
                                    <!--/keterangan terlambat-->
                                </t>
                            </td>
                        </tr>
                    </table>
                    <!--/header-->

                    <!--attendance-->
                    <table class="table table-condensed" style="font-size:65%;padding:0px;">

                        <!--sum variable-->
                        <t t-set="p_day_normal" t-value="0"/>
                        <t t-set="p_leave" t-value="0"/>
                        <t t-set="p_sick" t-value="0"/>
                        <t t-set="p_permit" t-value="0"/>
                        <t t-set="p_business_trip" t-value="0"/>
                        <t t-set="p_out_office" t-value="0"/>
                        <t t-set="p_no_reason" t-value="0"/>
                        <t t-set="p_day_finger" t-value="0"/>
                        <t t-set="p_piece_rate_day" t-value="0"/>
                        <t t-set="p_hour_late_office" t-value="0"/>
                        <t t-set="p_late_amount_office" t-value="0"/>
                        <t t-set="p_estate_late" t-value="0"/>
                        <t t-set="p_estate_late_amount" t-value="0"/>
                        <t t-set="p_labor_late_circle" t-value="0"/>
                        <t t-set="p_labor_late_circle_amount" t-value="0"/>
                        <t t-set="p_labor_late" t-value="0"/>
                        <t t-set="p_labor_late_amount" t-value="0"/>
                        <t t-set="p_hour_early_leave" t-value="0"/>
                        <t t-set="p_early_leave_amount" t-value="0"/>
                        <t t-set="p_sign_percent" t-value="0"/>
                        <t t-set="p_sign_percent_divide" t-value="0"/>
                        <t t-set="p_hour_work_float" t-value="0"/>
                        <t t-set="p_average_day_work" t-value="0"/>
                        <t t-set="p_average_day_work_divide" t-value="0"/>

                        <t t-set="hour_late_office_30" t-value="0"/>
                        <t t-set="late_amount_office_3" t-value="0"/>
                        <t t-set="estate_late_amount_3" t-value="0"/>

                        <!--/sum variable-->

                        <!--attendance header-->
                        <thead class="thead-inverse" style="display: table-header-group !important;">
                            <tr>
                                <th class="align-middle" rowspan="2" width="75">NIK</th>
                                <th class="align-middle" rowspan="2" width="200">Karyawan</th>
                                <th class="text-right" rowspan="2">Normal Hari Kerja</th>
                                <th class="text-center" colspan="6">Pengecualian</th>
                                <th class="text-right" rowspan="2">Riil Hari Kerja</th>

                                <t t-if="data['form']['office_level_id']">
                                    <t t-if="str(data['form']['office_level_id'][1]) != 'HO'">
                                        <th class="text-right" rowspan="2">Premi HK2</th>
                                    </t>
                                </t>

                                <!-- hide if office level estate -->
                                <t t-if="data['form']['office_level_id']">
                                    <t t-if="str(data['form']['office_level_id'][1]) != 'Estate'">
                                        <th class="text-center" colspan="2">Terlambat Kary Kantor</th>
                                    </t>
                                </t>

                                <!-- hide if office level is HO -->
                                <t t-if="data['form']['office_level_id']">
                                    <t t-if="str(data['form']['office_level_id'][1]) != 'HO'">
                                        <th class="text-center" colspan="2">Terlambat Kebun</th>
                                    </t>
                                </t>

                                <t t-if="data['form']['office_level_id']">
                                    <t t-if="str(data['form']['office_level_id'][1]) == 'Estate'">
                                        <th class="text-center" colspan="2">Terlambat KHL Apel</th>
                                        <th class="text-center" colspan="2">Terlambat KHL Kerja</th>
                                    </t>
                                </t>
                                <th class="text-right align-middle" rowspan="2">Pulang Cepat (Menit) All</th>
                                <th class="text-right align-middle" rowspan="2">Pulang Cepat (X) All</th>
                                <th class="text-right align-middle" rowspan="2">Avg Persen Scan</th>
                                <th class="text-right align-middle" rowspan="2">Jumlah Jam Kerja (Jam)</th>
                                <th class="text-right align-middle" rowspan="2">Avg Rata-Rata</th>
                            </tr>
                            <tr>
                                <!--pengecualian-->
                                <th class="text-right">Cuti</th>
                                <th class="text-right">Sakit</th>
                                <th class="text-right">Ijin</th>
                                <th class="text-right">Dinas Luar</th>
                                <th class="text-right">Keluar Kantor</th>
                                <th class="text-right">Mangkir</th>
                                <!--pengecualian-->
                                <!--terlambat-->

                                <!-- hide if office level estate -->
                                <t t-if="data['form']['office_level_id']">
                                    <t t-if="str(data['form']['office_level_id'][1]) != 'Estate'">
                                        <th class="text-right">Menit</th>
                                        <th class="text-right">X</th>
                                    </t>
                                </t>

                                <!-- hide if office level is HO-->
                                <t t-if="data['form']['office_level_id']">
                                    <t t-if="str(data['form']['office_level_id'][1]) != 'HO'">
                                        <th class="text-right">Menit</th>
                                        <th class="text-right">X</th>
                                    </t>
                                </t>

                                <t t-if="data['form']['office_level_id']">
                                    <t t-if="str(data['form']['office_level_id'][1]) == 'Estate'">
                                        <th class="text-right">Menit</th>
                                        <th class="text-right">X</th>
                                        <th class="text-right">Menit</th>
                                        <th class="text-right">X</th>
                                    </t>
                                </t>
                                <!--/terlambat-->
                            </tr>
                        </thead>
                        <!--/attendance header-->

                        <!--attendance body-->
                        <tbody style="display: table-row-group !important;">
                            <!--initial department-->
                            <t t-foreach="departments" t-as="department">
                                <tr>
                                    <td colspan="24" style="font-size: 120% !important;"><strong><t t-esc="department"/></strong></td>
                                </tr>

                                <!--single attendance-->
                                <t t-foreach="attendances" t-as="a">
                                    <t t-if="department == a['department']">
                                        <tr class="page-break">
                                            <td><t t-esc="a['nik']"/></td>
                                            <td><t t-esc="a['employee_name']"/></td>
                                            <td class="text-right"><t t-esc="a['p_day_normal']"/></td>
                                            <td class="text-right"><t t-esc="a['p_leave']"/></td>
                                            <td class="text-right"><t t-esc="a['p_sick']"/></td>
                                            <td class="text-right"><t t-esc="a['p_permit']"/></td>
                                            <td class="text-right"><t t-esc="a['p_business_trip']"/></td>
                                            <td class="text-right"><t t-esc="a['p_out_office']"/></td>
                                            <td class="text-right"><t t-esc="a['p_no_reason']"/></td>
                                            <td class="text-right"><t t-esc="a['p_day_finger']"/></td>
                                            <t t-if="data['form']['office_level_id']">
                                                <t t-if="str(data['form']['office_level_id'][1]) != 'HO'">
                                                    <td class="text-right"><t t-esc="a['p_piece_rate_day']"/></td>
                                                </t>
                                            </t>

                                            <!--different color based on value-->
                                            <!--
                                            <td class="text-right" t-att-style="get_color('p_hour_late_office',a['p_hour_late_office'])"><t t-esc="a['p_hour_late_office']"/></td>
                                            <td class="text-right" t-att-style="get_color('p_late_amount_office',a['p_late_amount_office'])"><t t-esc="a['p_late_amount_office']"/></td>
                                            <td class="text-right" t-att-style="get_color('p_estate_late',a['p_estate_late'])"><t t-esc="a['p_estate_late']"/></td>
                                            <td class="text-right" t-att-style="get_color('p_estate_late_amount',a['p_estate_late_amount'])"><t t-esc="a['p_estate_late_amount']"/></td>
                                            -->
                                            <!-- hide if office level estate -->
                                            <t t-if="data['form']['office_level_id']">
                                                <t t-if="str(data['form']['office_level_id'][1]) != 'Estate'">
                                                    <td class="text-right"><span t-att-class="get_color('p_hour_late_office',a['p_hour_late_office'])"/> <t t-esc="a['p_hour_late_office']"/></td>
                                                    <td class="text-right"><span t-att-class="get_color('p_late_amount_office',a['p_late_amount_office'])"/> <t t-esc="a['p_late_amount_office']"/></td>
                                                </t>
                                            </t>
                                            <!-- hide if office level is HO -->
                                            <t t-if="data['form']['office_level_id']">
                                                <t t-if="str(data['form']['office_level_id'][1]) != 'HO'">
                                                    <td class="text-right"><span t-att-class="get_color('p_estate_late',a['p_estate_late'])"/> <t t-esc="a['p_estate_late']"/></td>
                                                    <td class="text-right"><span t-att-class="get_color('p_estate_late_amount',a['p_estate_late_amount'])"/> <t t-esc="a['p_estate_late_amount']"/></td>
                                                </t>
                                            </t>

                                             <t t-if="data['form']['office_level_id']">
                                                <t t-if="str(data['form']['office_level_id'][1]) == 'Estate'">

                                                    <!--same color if value > 0-->
                                                    <td class="text-right"><t t-if="a['p_labor_late_circle'] >= 1"><span class="fa fa-circle-goldenrod"/></t> <t t-esc="a['p_labor_late_circle']"/></td>
                                                    <td class="text-right"><t t-if="a['p_labor_late_circle_amount'] >= 1"><span class="fa fa-circle-goldenrod"/></t> <t t-esc="a['p_labor_late_circle_amount']"/></td>
                                                    <td class="text-right"><t t-if="a['p_labor_late'] >= 1"><span class="fa fa-circle-goldenrod"/></t> <t t-esc="a['p_labor_late']"/></td>
                                                    <td class="text-right"><t t-if="a['p_labor_late_amount'] >= 1"><span class="fa fa-circle-goldenrod"/></t> <t t-esc="a['p_labor_late_amount']"/></td>
                                                </t>
                                            </t>
                                            <td class="text-right"><t t-esc="a['p_hour_early_leave']"/></td>
                                            <td class="text-right"><t t-esc="a['p_early_leave_amount']"/></td>
                                            <td class="text-right"><t t-esc="a['p_sign_percent']"/></td>
                                            <td class="text-right"><t t-esc="a['p_hour_work_float']"/></td>
                                            <td class="text-right"><t t-esc="a['p_average_day_work']"/></td>
                                        </tr>

                                        <!--calculate-->
                                        <t t-if="a['p_hour_late_office'] >= 31">
                                            <t t-set="hour_late_office_30" t-value="a['p_hour_late_office']-30"/>
                                            <t t-set="sum_hour_late_office_30"
                                               t-value="sum_hour_late_office_30 + hour_late_office_30"/>
                                        </t>
                                        <t t-if="a['p_hour_late_office'] >= 31">
                                            <t t-set="sum_hour_late_office_person"
                                               t-value="sum_hour_late_office_person+1"/>
                                        </t>
                                        <t t-if="a['p_late_amount_office'] >= 4">
                                            <t t-set="sum_late_amount_office_3"
                                               t-value="sum_late_amount_office_3+1"/>
                                        </t>
                                        <t t-if="a['p_late_amount_office'] >= 4">
                                            <t t-set="sum_late_amount_office_person"
                                               t-value="sum_late_amount_office_person+1"/>
                                        </t>
                                        <t t-if="a['p_estate_late_amount'] >= 4">
                                            <t t-set="estate_late_amount_3" t-value="a['p_estate_late_amount']-3"/>
                                            <t t-set="sum_estate_late_amount"
                                               t-value="sum_estate_late_amount+estate_late_amount_3"/>
                                        </t>
                                        <t t-if="a['p_estate_late_amount'] >= 4">
                                            <t t-set="sum_estate_late_amount_person"
                                               t-value="sum_estate_late_amount_person+1"/>
                                        </t>
                                        <t t-if="a['p_labor_late_circle_amount'] >= 1">
                                            <t t-set="sum_labor_late_circle_amount_person"
                                               t-value="sum_labor_late_circle_amount_person+1"/>
                                        </t>
                                        <t t-if="a['p_labor_late_amount'] >= 1">
                                            <t t-set="sum_labor_late_amount_person"
                                               t-value="sum_labor_late_amount_person+1"/>
                                        </t>
                                        <t t-if="a['p_early_leave_amount'] >= 1">
                                            <t t-set="sum_p_early_leave_person"
                                                t-value="sum_p_early_leave_person+1"/>
                                        </t>

                                        <t t-set="p_day_normal" t-value="p_day_normal+a['p_day_normal']"/>
                                        <t t-set="p_leave" t-value="p_leave+a['p_leave']"/>
                                        <t t-set="p_sick" t-value="p_sick+a['p_sick']"/>
                                        <t t-set="p_permit" t-value="p_permit+a['p_permit']"/>
                                        <t t-set="p_business_trip" t-value="p_business_trip+a['p_business_trip']"/>
                                        <t t-set="p_out_office" t-value="p_out_office+a['p_out_office']"/>
                                        <t t-set="p_no_reason" t-value="p_no_reason+a['p_no_reason']"/>
                                        <t t-set="p_day_finger" t-value="p_day_finger+a['p_day_finger']"/>
                                        <t t-set="p_piece_rate_day" t-value="p_piece_rate_day+a['p_piece_rate_day']"/>
                                        <t t-set="p_hour_late_office" t-value="p_hour_late_office+a['p_hour_late_office']"/>
                                        <t t-set="p_late_amount_office" t-value="p_late_amount_office+a['p_late_amount_office']"/>
                                        <t t-set="p_estate_late" t-value="p_estate_late+a['p_estate_late']"/>
                                        <t t-set="p_estate_late_amount" t-value="p_estate_late_amount+a['p_estate_late_amount']"/>
                                        <t t-set="p_labor_late_circle" t-value="p_labor_late_circle+a['p_labor_late_circle']"/>
                                        <t t-set="p_labor_late_circle_amount" t-value="p_labor_late_circle_amount+a['p_labor_late_circle_amount']"/>
                                        <t t-set="p_labor_late" t-value="p_labor_late+a['p_labor_late']"/>
                                        <t t-set="p_labor_late_amount" t-value="p_labor_late_amount+a['p_labor_late_amount']"/>
                                        <t t-set="p_hour_early_leave" t-value="p_hour_early_leave+a['p_hour_early_leave']"/>
                                        <t t-set="p_early_leave_amount" t-value="p_early_leave_amount+a['p_early_leave_amount']"/>
                                        <t t-set="p_sign_percent" t-value="p_sign_percent+a['p_sign_percent']"/>
                                        <t t-set="p_sign_percent_divide" t-value="p_sign_percent_divide+1"/>
                                        <t t-set="p_hour_work_float" t-value="p_hour_work_float+a['p_hour_work_float']"/>
                                        <t t-set="p_average_day_work" t-value="p_average_day_work+a['p_average_day_work']"/>
                                        <t t-set="p_average_day_work_divide" t-value="p_average_day_work_divide+1"/>
                                        <!--/calculate-->
                                    </t>
                                </t>
                                <!--/single attendance-->
                            </t>

                        </tbody>
                        <!--/attendance body-->

                        <!--attendance footer-->
                        <!--put tfoot after tbody for calculation-->
                        <!--<tfoot>-->
                            <tr>
                                <td colspan="2" class="text-right"><strong>Total</strong></td>
                                <td class="text-right"><strong><t t-esc="'{0:,.0f}'.format(p_day_normal)"/></strong></td>
                                <td class="text-right"><strong><t t-esc="'{0:,.0f}'.format(p_leave)"/></strong></td>
                                <td class="text-right"><strong><t t-esc="'{0:,.0f}'.format(p_sick)"/></strong></td>
                                <td class="text-right"><strong><t t-esc="'{0:,.0f}'.format(p_permit)"/></strong></td>
                                <td class="text-right"><strong><t t-esc="'{0:,.0f}'.format(p_business_trip)"/></strong></td>
                                <td class="text-right"><strong><t t-esc="'{0:,.0f}'.format(p_out_office)"/></strong></td>
                                <td class="text-right"><strong><t t-esc="'{0:,.0f}'.format(p_no_reason)"/></strong></td>
                                <td class="text-right"><strong><t t-esc="'{0:,.0f}'.format(p_day_finger)"/></strong></td>
                                <t t-if="data['form']['office_level_id']">
                                    <t t-if="str(data['form']['office_level_id'][1]) != 'HO'">
                                        <td class="text-right"><strong><t t-esc="'{0:,.0f}'.format(p_piece_rate_day)"/></strong></td>
                                    </t>
                                </t>

                                <!-- hide if office level estate -->
                                <t t-if="data['form']['office_level_id']">
                                    <t t-if="str(data['form']['office_level_id'][1]) != 'Estate'">
                                    <td class="text-right"><strong><t t-esc="'{0:,.0f}'.format(p_hour_late_office)"/></strong></td>
                                        <td class="text-right"><strong><t t-esc="'{0:,.0f}'.format(p_late_amount_office)"/></strong></td>
                                    </t>
                                </t>

                                <!-- hide if office level is HO -->
                                <t t-if="data['form']['office_level_id']">
                                    <t t-if="str(data['form']['office_level_id'][1]) != 'HO'">
                                        <td class="text-right"><strong><t t-esc="'{0:,.0f}'.format(p_estate_late)"/></strong></td>
                                        <td class="text-right"><strong><t t-esc="'{0:,.0f}'.format(p_estate_late_amount)"/></strong></td>
                                    </t>
                                </t>

                                <t t-if="data['form']['office_level_id']">
                                    <t t-if="str(data['form']['office_level_id'][1]) == 'Estate'">
                                        <td class="text-right"><strong><t t-esc="'{0:,.0f}'.format(p_labor_late_circle)"/></strong></td>
                                        <td class="text-right"><strong><t t-esc="'{0:,.0f}'.format(p_labor_late_circle_amount)"/></strong></td>
                                        <td class="text-right"><strong><t t-esc="'{0:,.0f}'.format(p_labor_late)"/></strong></td>
                                        <td class="text-right"><strong><t t-esc="'{0:,.0f}'.format(p_labor_late_amount)"/></strong></td>
                                    </t>
                                </t>
                                <td class="text-right"><strong><t t-esc="'{0:,.0f}'.format(p_hour_early_leave)"/></strong></td>
                                <td class="text-right"><strong><t t-esc="'{0:,.0f}'.format(p_early_leave_amount)"/></strong></td>
                                <td class="text-right"><strong><t t-if="p_sign_percent_divide != 0"><t t-esc="'{0:,.2f}'.format(p_sign_percent/p_sign_percent_divide)"/></t></strong></td>
                                <td class="text-right"><strong><t t-esc="'{0:,.2f}'.format(p_hour_work_float)"/></strong></td>
                                <td class="text-right"><strong><t t-if="p_average_day_work_divide != 0"><t t-esc="'{0:,.2f}'.format(p_average_day_work/p_average_day_work_divide)"/></t></strong></td>
                            </tr>

                            <!--summary-->
                            <t t-if="p_sign_percent_divide != 0">
                                <t t-set="avg_day_work" t-value="'{0:,.2f}'.format(p_sign_percent/p_sign_percent_divide)"/>
                            </t>

                            <t t-if="p_average_day_work_divide != 0">
                                <t t-set="avg_day_work_divide" t-value="'{0:,.2f}'.format(p_average_day_work/p_average_day_work_divide)"/>
                            </t>

                            <t t-set="sum_hour_late_office" t-value="'{0:,.0f}'.format(p_hour_late_office)"/>
                            <t t-set="sum_late_amount_office" t-value="'{0:,.0f}'.format(p_late_amount_office)"/>
                            <t t-set="sum_labor_late_circle" t-value="'{0:,.0f}'.format(p_labor_late_circle)"/>
                            <t t-set="sum_labor_late_circle_amount" t-value="'{0:,.0f}'.format(p_labor_late_circle_amount)"/>
                            <t t-set="sum_labor_late" t-value="'{0:,.0f}'.format(p_labor_late)"/>
                            <t t-set="sum_labor_late_amount" t-value="'{0:,.0f}'.format(p_labor_late_amount)"/>

                            <t t-set="sum_hour_late_office_person" t-value="sum_hour_late_office_person"/>

                            <t t-set="sum_p_hour_early_leave" t-value="'{0:,.0f}'.format(p_hour_early_leave)"/>
                            <t t-set="sum_p_early_leave_amount" t-value="'{0:,.0f}'.format(p_early_leave_amount)"/>
                            <!--/summary-->
                        <!--</tfoot>-->
                        <!--/attendance footer-->
                    </table>
                    <!--/attendance-->

                    <small>Data perusahaan, departemen, status PKWT/PKWTT harian/bulanan sesuai data karyawan pada saat sinkronisasi
                    sidik jari dari AMS ke Odoo dilakukan. Perubahan data setelah proses sinkronisasi tidak merubah laporan presensi.</small>

                    <small>Tanggal cetak: <t t-esc="datetime.datetime.today().strftime('%d-%b-%Y')"/></small>
                </div>
                <!--/page 1-->

                <!--page 2-->
                <div class="page">
                    <!-- !important override bootstrap td's -->
                    <style>
                        table.table-condensed td {
                            padding: 2px 4px !important;
                        }
                    </style>

                    <!--header-->
                    <h2 class="text-center">Laporan Presensi</h2>
                    <!--periode-->
                    <table class="table table-condensed" width="auto"  style="font-size:65%;padding:0px;">
                        <tr>
                            <td><strong>Tanggal</strong></td>
                            <td>
                                <t t-esc="datetime.datetime.strptime(str(data['form']['date_start']), '%Y-%m-%d').strftime('%d-%b-%Y')"/>
                                - <t t-esc="datetime.datetime.strptime(str(data['form']['date_end']), '%Y-%m-%d').strftime('%d-%b-%Y')"/>
                            </td>
                        </tr>
                        <tr>
                            <td><strong>Perusahaan</strong></td>
                            <td><t t-if="data['form']['company_id']"><t t-esc="str(data['form']['company_id'][1])"/></t></td>
                        </tr>
                        <tr>
                            <td><strong>Departemen</strong></td>
                            <td><t t-if="data['form']['department_id']"><t t-esc="str(data['form']['department_id'][1])"/></t></td>
                        </tr>
                        <tr>
                            <td><strong>Jenis Kantor</strong></td>
                            <td><t t-if="data['form']['office_level_id']"><t t-esc="str(data['form']['office_level_id'][1])"/></t></td>
                        </tr>
                        <tr>
                            <td><strong>Status Karyawan</strong></td>
                            <td>
                                <t t-if="data['form']['contract_type']">
                                    <t t-if="data['form']['contract_type']=='1'">PKWTT</t><t t-if="data['form']['contract_type']=='2'">PKWT</t>
                                </t>
                                <t t-if="data['form']['contract_period']">
                                    - <t t-if="data['form']['contract_period']=='1'">Bulanan</t><t t-if="data['form']['contract_period']=='2'">Harian</t>
                                </t>
                            </td>
                        </tr>
                    </table>
                    <!--periode-->
                    <!--/header-->

                    <p/>

                    <!--remark-->
                    <table class="table table-condensed" style="font-size:65%;padding:0px;">
                        <tr>
                            <td width="50%">
                                <!--pengecualian-->
                                <table class="table table-condensed">
                                    <thead>
                                        <th>Alasan Pengecualian</th>
                                        <th class="text-right">Orang</th>
                                        <th class="text-right">Keterangan</th>
                                    </thead>
                                    <t t-foreach="remarks" t-as="r">
                                        <t t-if="r['reason'] != 'Pulang Cepat'">
                                            <tr>
                                                <td class="col-md-1"><t t-esc="r['reason']"/></td>
                                                <td class="col-md-1 text-right"><t t-esc="r['person']"/> orang</td>
                                                <td class="col-md-1 text-right"><span t-if="r['amount']!=''"><t t-esc="r['amount']"/></span></td>
                                            </tr>
                                        </t>
                                        <t t-if="r['reason'] == 'Pulang Cepat'">
                                            <tr>
                                                <td class="col-md-1"><t t-esc="r['reason']"/></td>
                                                <td class="col-md-1 text-right"><t t-esc="sum_p_early_leave_person"/> orang</td>
                                                <td class="col-md-1 text-right"><span t-if="r['amount']!=''"><t t-esc="r['amount']"/></span></td>
                                            </tr>
                                        </t>
                                    </t>
                                </table>
                                <!--/pengecualian-->
                            </td>
                            <td width="50%">
                                <!--persentase-->
                                <table class="table table-condensed col-md-6">
                                    <thead>
                                        <th colspan="2">Kehadiran</th>
                                    </thead>
                                    <tr>
                                        <td>Sidik Jari</td>
                                        <td><t t-esc="avg_day_work"/> %</td>
                                    </tr>
                                    <tr>
                                        <td>Kehadiran</td>
                                        <td><t t-esc="avg_day_work_divide"/> %</td>
                                    </tr>
                                </table>
                                <!--/persentase-->
                                <p/>
                                <!--terlambat-->
                                <table class="table table-condensed">
                                    <thead>
                                        <th>Keterangan Terlambat</th>
                                        <th class="text-right">Menit/X</th>
                                        <th class="text-right">Keterangan</th>
                                    </thead>
                                    <!-- hide if site office is HO -->
                                    <t t-if="data['form']['office_level_id']">
                                        <t t-if="str(data['form']['office_level_id'][1]) != 'Estate'">
                                            <tr>
                                                <td rowspan="2">Kantor (>30 menit/>3 kali)</td>
                                                <td class="text-right"><t t-esc="sum_hour_late_office_30"/> menit</td>
                                                <td class="text-right"><t t-esc="sum_hour_late_office_person"/> orang</td>
                                            </tr>
                                            <tr>
                                                <td class="text-right"><t t-esc="sum_late_amount_office_3"/> kali</td>
                                                <td class="text-right"><t t-esc="sum_late_amount_office_person"/> orang</td>
                                            </tr>
                                        </t>
                                    </t>
                                    <!-- hide if site office is HO -->
                                    <t t-if="data['form']['office_level_id']">
                                        <t t-if="str(data['form']['office_level_id'][1]) != 'HO'">
                                            <tr>
                                                <td>Kebun</td>
                                                <td class="text-right"><t t-esc="sum_estate_late_amount"/> kali</td>
                                                <td class="text-right"><t t-esc="sum_estate_late_amount_person"/> orang</td>
                                            </tr>
                                        </t>
                                    </t>
                                    <t t-if="data['form']['office_level_id']">
                                        <t t-if="str(data['form']['office_level_id'][1]) == 'Estate'">
                                            <tr>
                                                <td>Apel Pagi</td>
                                                <td class="text-right"><t t-esc="sum_labor_late_circle_amount"/> kali</td>
                                                <td class="text-right"><t t-esc="sum_labor_late_circle_amount_person"/> orang</td>
                                            </tr>
                                            <tr>
                                                <td>Jam Kerja</td>
                                                <td class="text-right"><t t-esc="sum_labor_late_amount"/> kali</td>
                                                <td class="text-right"><t t-esc="sum_labor_late_amount_person"/> orang</td>
                                            </tr>
                                        </t>
                                    </t>
                                    <!--
                                    <tr>
                                        <td>Pulang Cepat</td>
                                        <td class="text-right"><t t-esc="sum_p_hour_early_leave"/> menit</td>
                                        <td class="text-right"><t t-esc="sum_p_early_leave_amount"/> kali</td>
                                    </tr>
                                    -->
                                </table>
                                <!--/terlambat-->
                            </td>
                        </tr>
                    </table>
                    <!--/remark-->

                    <small>Alasan ketidakhadiran sesuai master data ketidakhadiran. Data sesuai dengan hasil sinkronisasi
                    sidik jari dari AMS ke Odoo. Perubahan data setelah proses sinkronisasi membutuhkan proses cetak ulang laporan.</small>

                    <small>Tanggal cetak: <t t-esc="datetime.datetime.today().strftime('%d-%b-%Y')"/></small>
                </div>
                <!--/page 2-->
            </t>
        </template>
    </data>
</openerp>